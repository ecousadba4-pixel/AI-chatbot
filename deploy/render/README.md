# Деплой на Render

Эта директория содержит минимальные файлы, необходимые для подготовки отдельной ветки/сервиса на Render.

## Что входит

- `render.yaml` — инфраструктурный манифест Render, который разворачивает Docker-контейнер из текущего репозитория.
  - Значения `qdrant.example.com` и `redis.example.com` нужно заменить на реальные публичные хосты ваших Qdrant и Redis.
  - Секреты `QDRANT_API_KEY`, `AMVERA_GPT_MODEL`, `AMVERA_GPT_TOKEN` помечены как `sync: false`, поэтому их нужно добавить вручную через панель Render.
- `.env.render.example` — пример файла с переменными окружения, который можно использовать как подсказку при заполнении панели Render.

## Как использовать

1. Создайте новую ветку (например, `render-deploy`) и скопируйте в неё содержимое этой директории.
2. Внесите правки в `render.yaml`: укажите реальные URL сервисов, нужный регион и лимиты.
3. В интерфейсе Render выберите **New → Blueprint**, подключите ветку и подтвердите деплой.
4. После создания сервиса настройте переменные окружения и секреты в разделе **Environment**.
5. Приложение будет слушать порт из переменной `PORT`, который Render пробрасывает автоматически.

## Настройка переменных окружения

Для удалённых Qdrant и Redis необходимо задать:

- `QDRANT_HOST`, `QDRANT_PORT`, `QDRANT_HTTPS`, `QDRANT_API_KEY`
- `REDIS_HOST`, `REDIS_PORT`

Все остальные переменные соответствуют конфигурации Amvera и уже используются в приложении (`config.py`).

## Проверка

После деплоя убедитесь, что `/health` возвращает статус 200, а приложение успешно подключается к внешним Qdrant и Redis. Если соединение не устанавливается, проверьте, что в Render разрешён исходящий трафик к этим сервисам и заданы корректные креды.
